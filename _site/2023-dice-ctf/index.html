<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>2023 Dice Ctf</title><!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v3.9.4" />
<meta property="og:title" content="2023 Dice Ctf" />
<meta name="author" content="김민순" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Wonder Why" />
<meta property="og:description" content="Wonder Why" />
<link rel="canonical" href="http://localhost:4000/2023-dice-ctf/" />
<meta property="og:url" content="http://localhost:4000/2023-dice-ctf/" />
<meta property="og:site_name" content="I’m such a good surfer" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-02-06T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="2023 Dice Ctf" />
<script type="application/ld+json">
{"description":"Wonder Why","url":"http://localhost:4000/2023-dice-ctf/","@type":"BlogPosting","headline":"2023 Dice Ctf","dateModified":"2023-02-06T00:00:00+09:00","datePublished":"2023-02-06T00:00:00+09:00","author":{"@type":"Person","name":"김민순"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2023-dice-ctf/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="I&apos;m such a good surfer" /><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$'] ],
    processEscapes: true,
  }
});
MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
	  alert("Math Processing Error: "+message[1]);
	});
MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
	  alert("Math Processing Error: "+message[1]);
	});
</script>


<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

  <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
  <link rel="stylesheet" href="/assets/css/main.css" />
</head>
<body a="dark">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <a href="/">cd ..</a><article>
  <p class="post-meta">
    <font size="2em">soon_haari</font>
    <time datetime="2023-02-06 00:00:00 +0900">2023-02-06</time>
  </p>
  
  <h1>2023 Dice Ctf</h1>

  <p><br /><br /></p>

<p>I participated in DiceCTF 2023 this weekend.<br />
Huge applause to our team, everyone who participated, and respect to challenge authors.</p>

<p>I solved the following 4 crypto challenges. Took way too much time dealing with ‘BBBB’ considering I got the hang of it at the first place already.</p>

<p><br /><br /></p>

<h2 id="provably-secure--provably-secure-2"><strong>Provably Secure &amp; Provably Secure 2</strong></h2>

<p>I solved normal ‘Provably Secure’ with the solution for ‘Probvably Secure 2’. First I didn’t even know the difference for those 2 challenges, but then later realized that normal one has no filtering at all, due to coding miss, so you can just directly decrypt the message.</p>

<p>I will just write solution for ‘Provably Secure 2’ at this point.</p>

<h3 id="serverpy"><strong>server.py</strong></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/local/bin/python
</span>
<span class="c1"># Normally you have unlimited encryption and decryption query requests in the IND-CCA2 game.
# For performance reasons, my definition of unlimited is 8 lol
</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.asymmetric</span> <span class="kn">import</span> <span class="n">rsa</span><span class="p">,</span> <span class="n">padding</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives</span> <span class="kn">import</span> <span class="n">hashes</span>
<span class="kn">from</span> <span class="nn">secrets</span> <span class="kn">import</span> <span class="n">randbits</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">urandom</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.strxor</span> <span class="kn">import</span> <span class="n">strxor</span>

<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">pk0</span><span class="p">,</span> <span class="n">pk1</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">r_prime</span> <span class="o">=</span> <span class="n">strxor</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
    <span class="n">ct0</span> <span class="o">=</span> <span class="n">pk0</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">padding</span><span class="p">.</span><span class="n">OAEP</span><span class="p">(</span><span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="p">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">()),</span>
                         <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
    <span class="n">ct1</span> <span class="o">=</span> <span class="n">pk1</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">r_prime</span><span class="p">,</span> <span class="n">padding</span><span class="p">.</span><span class="n">OAEP</span><span class="p">(</span><span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="p">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">()),</span> 
                         <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">ct0</span><span class="p">.</span><span class="nb">hex</span><span class="p">()</span> <span class="o">+</span> <span class="n">ct1</span><span class="p">.</span><span class="nb">hex</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">key0</span><span class="p">,</span> <span class="n">key1</span><span class="p">,</span> <span class="n">ct</span><span class="p">):</span>
    <span class="n">ct0</span> <span class="o">=</span> <span class="n">ct</span><span class="p">[:</span><span class="mi">256</span><span class="p">]</span>
    <span class="n">ct1</span> <span class="o">=</span> <span class="n">ct</span><span class="p">[</span><span class="mi">256</span><span class="p">:]</span>
    <span class="n">r0</span> <span class="o">=</span> <span class="n">key0</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ct0</span><span class="p">,</span> <span class="n">padding</span><span class="p">.</span><span class="n">OAEP</span><span class="p">(</span><span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="p">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">()),</span>
                           <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
    <span class="n">r1</span> <span class="o">=</span> <span class="n">key1</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ct1</span><span class="p">,</span> <span class="n">padding</span><span class="p">.</span><span class="n">OAEP</span><span class="p">(</span><span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="p">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">()),</span>
                           <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">strxor</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span> <span class="n">r1</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"""Actions:
0) Solve
1) Query Encryption
2) Query Decryption
"""</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">experiment</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">129</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Experiment {}/128"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">experiment</span><span class="p">))</span>
        <span class="n">key0</span> <span class="o">=</span> <span class="n">rsa</span><span class="p">.</span><span class="n">generate_private_key</span><span class="p">(</span><span class="n">public_exponent</span><span class="o">=</span><span class="mi">65537</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>
        <span class="n">key1</span> <span class="o">=</span> <span class="n">rsa</span><span class="p">.</span><span class="n">generate_private_key</span><span class="p">(</span><span class="n">public_exponent</span><span class="o">=</span><span class="mi">65537</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>
        <span class="n">pk0</span> <span class="o">=</span> <span class="n">key0</span><span class="p">.</span><span class="n">public_key</span><span class="p">()</span>
        <span class="n">pk1</span> <span class="o">=</span> <span class="n">key1</span><span class="p">.</span><span class="n">public_key</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"pk0 ="</span><span class="p">,</span> <span class="n">pk0</span><span class="p">.</span><span class="n">public_numbers</span><span class="p">().</span><span class="n">n</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"pk1 ="</span><span class="p">,</span> <span class="n">pk1</span><span class="p">.</span><span class="n">public_numbers</span><span class="p">().</span><span class="n">n</span><span class="p">)</span>
        <span class="n">m_bit</span> <span class="o">=</span> <span class="n">randbits</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">seen_ct</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">en_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">de_count</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">choice</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s">"Action: "</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">guess</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s">"m_bit guess: "</span><span class="p">))</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">guess</span> <span class="o">==</span> <span class="n">m_bit</span><span class="p">):</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"Correct!"</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"Wrong!"</span><span class="p">)</span>
                    <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">en_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">en_count</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">):</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"You've run out of encryptions!"</span><span class="p">)</span>
                    <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">m0</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s">"m0 (16 byte hexstring): "</span><span class="p">).</span><span class="n">strip</span><span class="p">())</span>
                <span class="n">m1</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s">"m1 (16 byte hexstring): "</span><span class="p">).</span><span class="n">strip</span><span class="p">())</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">m0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">16</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">16</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"Must be 16 bytes!"</span><span class="p">)</span>
                    <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">m0</span> <span class="k">if</span> <span class="n">m_bit</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">m1</span>
                <span class="n">ct</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">pk0</span><span class="p">,</span> <span class="n">pk1</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
                <span class="n">seen_ct</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
            
            <span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">de_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">de_count</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">):</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"You've run out of decryptions!"</span><span class="p">)</span>
                    <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">in_ct</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s">"ct (512 byte hexstring): "</span><span class="p">).</span><span class="n">strip</span><span class="p">())</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">in_ct</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">512</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"Must be 512 bytes!"</span><span class="p">)</span>
                    <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">in_ct</span><span class="p">.</span><span class="nb">hex</span><span class="p">()</span> <span class="ow">in</span> <span class="n">seen_ct</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"Cannot query decryption on seen ciphertext!"</span><span class="p">)</span>
                    <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">decrypt</span><span class="p">(</span><span class="n">key0</span><span class="p">,</span> <span class="n">key1</span><span class="p">,</span> <span class="n">in_ct</span><span class="p">).</span><span class="nb">hex</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'flag.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Flag: "</span> <span class="o">+</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">strip</span><span class="p">())</span>
</code></pre></div></div>

<p><br /></p>

<p>We can assume there is nothing we can do with OAEP’s vulnerability, since it already includes sha256 hash.</p>

<p>But the decrypting system decrypts 2 blocks individually, and the filtering system just checks if the 2 blocks are the exact same.</p>

<p>So I thought, we encrypt 2 times, and decrypt with first encryption’s front block, and second encryption’s back block.</p>

<p><br /></p>

<p>When I optimized my theory, it looked like this.</p>

<p>First we have to encrypt the message 3 times(I saw another solutions using just 2 though).</p>

<p>e1 = [enc0(r1), enc1(r1 ^ msg)]<br />
e2 = [enc0(r2), enc1(r2 ^ msg)]<br />
e3 = [enc0(r3), enc1(r3 ^ msg)]</p>

<p><br /></p>

<p>Then we decrypt these three messages.</p>

<p>dec([enc0(r1), enc1(r2 ^ msg)]) = r1^r2^msg<br />
dec([enc0(r2), enc1(r3 ^ msg)]) = r2^r3^msg<br />
dec([enc0(r3), enc1(r1 ^ msg)]) = r3^r1^msg</p>

<p>If we xor all three of them, we can easily get the message.</p>

<p><br /></p>

<p>Here is my final ex code.</p>

<h3 id="exsage"><strong>ex.sage</strong></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.asymmetric</span> <span class="kn">import</span> <span class="n">rsa</span><span class="p">,</span> <span class="n">padding</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives</span> <span class="kn">import</span> <span class="n">hashes</span>
<span class="kn">from</span> <span class="nn">secrets</span> <span class="kn">import</span> <span class="n">randbits</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">urandom</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.strxor</span> <span class="kn">import</span> <span class="n">strxor</span>

<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">"mc.ax"</span><span class="p">,</span> <span class="mi">31497</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"step </span><span class="si">{</span><span class="n">_</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

    <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"pk0 = "</span><span class="p">)</span>
    <span class="n">n0</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">())</span>
    <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"pk1 = "</span><span class="p">)</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">())</span>

    <span class="n">enc_0</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">enc_1</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"Action: "</span><span class="p">,</span> <span class="s">"1"</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"m0 (16 byte hexstring): "</span><span class="p">,</span> <span class="s">"00"</span> <span class="o">*</span> <span class="mi">16</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"m1 (16 byte hexstring): "</span><span class="p">,</span> <span class="s">"11"</span> <span class="o">*</span> <span class="mi">16</span><span class="p">)</span>

        <span class="n">enc</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">decode</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span> <span class="o">==</span> <span class="mi">512</span>

        <span class="n">enc_0</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">enc</span><span class="p">[:</span><span class="mi">256</span><span class="p">])</span>
        <span class="n">enc_1</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">enc</span><span class="p">[</span><span class="mi">256</span><span class="p">:])</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x00</span><span class="s">"</span> <span class="o">*</span> <span class="mi">16</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"Action: "</span><span class="p">,</span> <span class="s">"2"</span><span class="p">)</span>
        <span class="n">send</span> <span class="o">=</span> <span class="n">enc_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">enc_1</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span><span class="p">]</span>
        <span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"ct (512 byte hexstring): "</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">.</span><span class="nb">hex</span><span class="p">(</span><span class="n">send</span><span class="p">))</span>
        
        <span class="n">dec</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">decode</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span> <span class="o">==</span> <span class="mi">16</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">dec</span><span class="p">)</span>

    <span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"Action: "</span><span class="p">,</span> <span class="s">"0"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">msg</span> <span class="o">==</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x00</span><span class="s">"</span> <span class="o">*</span> <span class="mi">16</span><span class="p">:</span>
        <span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"m_bit guess: "</span><span class="p">,</span> <span class="s">"0"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"m_bit guess: "</span><span class="p">,</span> <span class="s">"1"</span><span class="p">)</span>

<span class="n">io</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div></div>

<p><strong>Flag</strong></p>

<p>PV: dice{yeah_I_lost_like_10_points_on_that_proof_lmao}<br />
PV2: dice{my_professor_would_not_be_proud_of_me}</p>

<p><br /><br /></p>

<h2 id="rsabin"><strong>rSabin</strong></h2>

<h3 id="challengepy"><strong>challenge.py</strong></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">getPrime</span><span class="p">,</span> <span class="n">bytes_to_long</span>
<span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">PKCS1_OAEP</span>
<span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>

<span class="kn">from</span> <span class="nn">nth_root</span> <span class="kn">import</span> <span class="n">nth_root</span><span class="p">,</span> <span class="n">chinese_remainder</span> <span class="c1"># not provided
</span>
<span class="k">class</span> <span class="nc">Server</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="mi">17</span>
        <span class="n">nbits</span> <span class="o">=</span> <span class="mi">512</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="n">nbits</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="n">nbits</span><span class="p">)</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">p</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">q</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">e</span> <span class="o">=</span> <span class="n">e</span>

    <span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">N</span>
        <span class="n">c</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">e</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">N</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">N</span>
        <span class="n">mp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nth_root</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">e</span><span class="p">))</span>
        <span class="n">mq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nth_root</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">q</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">e</span><span class="p">))</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">chinese_remainder</span><span class="p">([</span><span class="n">mp</span><span class="p">,</span> <span class="n">mq</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">q</span><span class="p">])</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">encrypt_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"flag.txt"</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

        <span class="n">key</span> <span class="o">=</span> <span class="n">RSA</span><span class="p">.</span><span class="n">construct</span><span class="p">((</span><span class="bp">self</span><span class="p">.</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">e</span><span class="p">))</span>
        <span class="n">cipher</span> <span class="o">=</span> <span class="n">PKCS1_OAEP</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">c</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">Server</span><span class="p">()</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="p">(</span><span class="k">await</span> <span class="n">a</span><span class="p">.</span><span class="nb">input</span><span class="p">(</span><span class="s">"Enter your option (EDF) &gt; "</span><span class="p">)).</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">cmd</span> <span class="o">==</span> <span class="s">"E"</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="k">await</span> <span class="n">a</span><span class="p">.</span><span class="nb">input</span><span class="p">(</span><span class="s">"Enter your integer to encrypt &gt; "</span><span class="p">))</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">a</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cmd</span> <span class="o">==</span> <span class="s">"D"</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="k">await</span> <span class="n">a</span><span class="p">.</span><span class="nb">input</span><span class="p">(</span><span class="s">"Enter your integer to decrypt &gt; "</span><span class="p">))</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">S</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">a</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cmd</span> <span class="o">==</span> <span class="s">"F"</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="p">.</span><span class="n">encrypt_flag</span><span class="p">()</span>
            <span class="k">await</span> <span class="n">a</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
            <span class="k">return</span>

<span class="k">class</span> <span class="nc">Handler</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">writer</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">reader</span> <span class="o">=</span> <span class="n">reader</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">writer</span> <span class="o">=</span> <span class="n">writer</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">writer</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>
        <span class="k">await</span> <span class="bp">self</span><span class="p">.</span><span class="n">writer</span><span class="p">.</span><span class="n">drain</span><span class="p">()</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prompt</span><span class="p">):</span>
        <span class="k">await</span> <span class="bp">self</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="p">.</span><span class="n">reader</span><span class="p">.</span><span class="n">readline</span><span class="p">()).</span><span class="n">decode</span><span class="p">()</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">__aexit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_t</span><span class="p">,</span> <span class="n">exc_v</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">writer</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">await</span> <span class="bp">self</span><span class="p">.</span><span class="n">writer</span><span class="p">.</span><span class="n">wait_closed</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">exc_v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exc_v</span><span class="p">,</span> <span class="n">asyncio</span><span class="p">.</span><span class="nb">TimeoutError</span><span class="p">):</span>
            <span class="n">traceback</span><span class="p">.</span><span class="n">print_exception</span><span class="p">(</span><span class="n">exc_v</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">async</span> <span class="k">with</span> <span class="n">Handler</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="k">as</span> <span class="n">a</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">handle</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">server</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="n">start_server</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="s">'0.0.0.0'</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'listening'</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">with</span> <span class="n">server</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">server</span><span class="p">.</span><span class="n">serve_forever</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">asyncio</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div></div>

<p>I second blooded this challenge, thanks to some luck I had.</p>

<p>I was unsure how does nth_root function works, and I tried decrypting 1 multiple times for no reason.</p>

<p>1’s 17th root should be always 1, right, but I found sometimes it is not in low probability.</p>

<p><br /></p>

<p>I observed why it isn’t 1, and found out it is happening when p-1 or q-1 is multiple of e value which is 17.</p>

<p>Let’s assume p-1 is not multiple of 17, and q-1 is multiple of 17(Without Loss Of Generality).</p>

<p><br /></p>

<p>The decryption finds 17th root depending on p, q individually. So we can say 17th root of p is calculated correctly.<br />
After that we can see it calculates with CRT. So we can say</p>

<p>dec % p == 1</p>

<p><br /></p>

<p>This means dec - 1 is multiple of p, and if we find the value of n, we can get p’s value with GCD.<br />
Getting value of n is easy enough.</p>

<p>Since both p and q’s bit_length is 512, n’s bit_length should be around 1024, 
so when we encrypt 2^61, it should become 2^(61*17) 
= 2^1037.</p>

<p>2^1037 - enc(2^61) should be multiple of n, if we factor out the small multiple, we can get n’s value.<br />
Then we can finally get p and q’s value.</p>

<p>This is the code for collecting the values. I found n with factorDB, it is not heavy factoring at all.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">"mc.ax"</span><span class="p">,</span> <span class="mi">31370</span><span class="p">)</span>

    <span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"Enter your option (EDF) &gt; "</span><span class="p">,</span> <span class="s">"D"</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"Enter your integer to decrypt &gt; "</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">())</span>
    <span class="k">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">break</span>

    <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"Enter your option (EDF) &gt; "</span><span class="p">,</span> <span class="s">"E"</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"Enter your integer to encrypt &gt; "</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">61</span><span class="p">))</span>
<span class="n">enc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">())</span>

<span class="n">nmul</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="mi">61</span> <span class="o">*</span> <span class="mi">17</span><span class="p">)</span> <span class="o">-</span> <span class="n">enc</span>

<span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"Enter your option (EDF) &gt; "</span><span class="p">,</span> <span class="s">"F"</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">())</span>

<span class="k">print</span><span class="p">(</span><span class="n">nmul</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</code></pre></div></div>

<p><br /></p>

<p>As like all challenges when gcd(phi(n), e) &gt; 0, we have to check 17 possibilities.</p>

<p>The disturbing step is the PKCS1_OAEP actually haha.<br />
After the CTF ended, I saw some people looked up for implementation for PKCS1_OAEP to decrypt manually.</p>

<p>For me, I generated another q value (which $17 \nmid q - 1$ this time), and created another private RSA key, and made another cipher.</p>

<p>And cipher.decrypt() does all the job LOL. Quite neat right?</p>

<p>Here is my final ex code.</p>

<h3 id="exsage-1"><strong>ex.sage</strong></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">PKCS1_OAEP</span>
<span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>



<span class="n">nmul</span> <span class="o">=</span> <span class="mi">1472652434159470912717652477249629435288838642660072237733135353261210431116228248553975980211706774692931634311512685185865487901002152566198037716990062525940495276211736076829793428052109414039635475636893136335117172740673736934738697615380782000387169557073669482414190802882921184771103976730603474027568571</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">65218508357739351094678168808378222795836228873250917356076923974796498850037416350961686574551446156400306841574623055670195469503308577533679327001450403240311853731706027507515671967316704795205347956069238908679689738539924987372657739504485607577702302069253226736628602308321255282725166442485680199585</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">57816931865503984306516063152772233676118644798781873004195645287848832866141173472948992881001736064199811245895734601275395784423478282808860723558495979180040578988171301802518739535134189606472385840733816329925894907511746442431778101397560140643668504642635172995797036111267892860084796849795540372499</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">71756197152437309979908028906574547351207846935636711871224253435716534186825914756808262934839291267988677791332294751540490566730115117974859314768311773422038458130474885583481626860210954248386467652725875180778500840065961941954816431095881791180001440192645786795994289474390741352195291951985746432177</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">p</span>

<span class="k">assert</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="ow">and</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="ow">and</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="o">==</span> <span class="n">n</span>

<span class="n">e</span> <span class="o">=</span> <span class="mi">17</span>

<span class="c1"># q - 1 is multiple of 17
</span>
<span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi</span> <span class="o">//</span> <span class="n">e</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">L</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">phi</span> <span class="o">//</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>


<span class="n">ms</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="n">Li</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">X</span><span class="o">*</span><span class="n">Li</span> <span class="o">%</span> <span class="n">n</span>
    <span class="k">if</span> <span class="nb">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="n">f</span><span class="p">:</span>
       <span class="n">ms</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>



<span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
<span class="k">while</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">17</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>

<span class="n">cs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">newn</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
<span class="n">newd</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">ms</span><span class="p">:</span>
    <span class="n">cs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">newn</span><span class="p">)))</span>


<span class="n">key</span> <span class="o">=</span> <span class="n">RSA</span><span class="p">.</span><span class="n">construct</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">newn</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">newd</span><span class="p">)))</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="n">PKCS1_OAEP</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cs</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">cipher</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
</code></pre></div></div>

<p><strong>Flag</strong></p>

<p>dice{rabin-williams-cryptosystem-in-disguise-3038e78caa07}</p>

<p><br /><br /></p>

<h2 id="bbbb"><strong>BBBB</strong></h2>

<h3 id="bbbbpy"><strong>bbbb.py</strong></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/local/bin/python
</span><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">bytes_to_long</span><span class="p">,</span> <span class="n">getPrime</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">gcd</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">urandom</span>

<span class="k">def</span> <span class="nf">generate_key</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)):</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">rng</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">generate_params</span><span class="p">():</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">p</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">generate_params</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"[+] The parameters of RNG:"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">b</span><span class="o">=</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">p</span><span class="o">=</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s">"[+] Inject b[a]ckdoor!!: "</span><span class="p">))</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>

    <span class="n">keys</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">seeds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">seed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s">"[+] Please input seed: "</span><span class="p">))</span>
        <span class="n">seed</span> <span class="o">%=</span> <span class="n">p</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="ow">in</span> <span class="n">seeds</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"[!] Same seeds are not allowed!!"</span><span class="p">)</span>
            <span class="nb">exit</span><span class="p">()</span>
        <span class="n">seeds</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">n</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">generate_key</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">e</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"[!] `e` is so small!!"</span><span class="p">)</span>
            <span class="nb">exit</span><span class="p">()</span>

        <span class="n">keys</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">e</span><span class="p">))</span>

    <span class="n">FLAG</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"flag.txt"</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">FLAG</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">50</span>
    <span class="n">FLAG</span> <span class="o">=</span> <span class="n">FLAG</span> <span class="o">+</span> <span class="n">urandom</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">FLAG</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="nb">hex</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[+] Public Key:"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">n</span><span class="o">=</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">e</span><span class="o">=</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">r</span><span class="o">=</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[+] Cipher Text:"</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<p>The challenge was based on BBB on SECCON CTF 2022. <a href="https://ctftime.org/task/23982">https://ctftime.org/task/23982</a></p>

<p>Original challenge was to set all the e’s values to 11, and perform hastad’s attack.</p>

<p><br /></p>

<p>On this one, we can’t perform hastad’s attack since all the plaintexts are different due to added urandom(16).</p>

<p>But this was not the main point of the challenge, it could be easily solved with coppersmith after generating small polynomials. (But it took long time for me because I am not too fond with coppersmith… ㅠㅅㅠ)</p>

<p><br /></p>

<p>Anyways, the main point of this chall was to make small e values to make coppersmith work. I thought of making LCG into a loop in the first place.</p>

<p>Setting value a can do a huge job here.</p>

<p>LCG works like:<br />
$seed → a*seed + b → a^2*seed + b*(a + 1) → a^3*seed + b*(a^2 + a + 1) → ….$ and so on.</p>

<p>We can see if a is root of (a + 1 = 0), we can generate a loop with 2 elements, if a is root of (a^2 + a + 1 = 0), we can generate a loop with 3.<br />
I did with 3 because I was too much focusing on making e into exact 11.</p>

<p><br /></p>

<p>Let’s say we found a root for (a^2 + a + 1 = 0), and the elements in loop-11 is (11, A, B).</p>

<p>The seeds we should send is obviously 11, A, B. Since no same seeds are allowed, the maximum 11s we can get is 3 in this case.</p>

<p>When the challenge gives us e, it can be any value between (11, A, B), so it is not very wise to rely on 1/27 probability.</p>

<p>But when A, B is an even number, gcd with phi value never can be 1, so it is always filtered leaving 11 alone.<br />
That was how I made 3 datas with e=11.(I threw away the other large 2)</p>

<p>Gladly, coppersmith worked with just 3 of it.</p>

<p><br /></p>

<p>Here is my final ex code.</p>

<h3 id="exsage-2"><strong>ex.sage</strong></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">cypari2</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">pari</span> <span class="o">=</span> <span class="n">cypari2</span><span class="p">.</span><span class="n">Pari</span><span class="p">()</span>
<span class="n">pari</span><span class="p">.</span><span class="n">allocatemem</span><span class="p">(</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">)</span>


<span class="n">n1</span> <span class="o">=</span> <span class="mf">27954.</span><span class="p">..</span><span class="mi">9433</span>
<span class="n">r1</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">'54107efb65283d816bb7986bf684f101'</span><span class="p">))</span>
<span class="n">enc1</span> <span class="o">=</span> <span class="mf">17168.</span><span class="p">..</span><span class="mi">6062</span>

<span class="n">n2</span> <span class="o">=</span> <span class="mf">20353.</span><span class="p">..</span><span class="mi">9779</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">'67a7ba893badda86ccca15b70ada1c81'</span><span class="p">))</span>
<span class="n">enc2</span> <span class="o">=</span> <span class="mf">13271.</span><span class="p">..</span><span class="mi">9198</span>

<span class="n">n3</span> <span class="o">=</span> <span class="mf">13197.</span><span class="p">..</span><span class="mi">3569</span>
<span class="n">r3</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">'f8f10bc4c2601ff2f92bf52f4b79cdba'</span><span class="p">))</span>
<span class="n">enc3</span> <span class="o">=</span> <span class="mf">44466.</span><span class="p">..</span><span class="mi">9519</span>

<span class="n">crtcoef</span> <span class="o">=</span> <span class="p">[(</span><span class="n">n2</span><span class="o">*</span><span class="n">n3</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="n">n2</span><span class="o">*</span><span class="n">n3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n1</span><span class="p">)),</span> <span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">n3</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">n3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n2</span><span class="p">)),</span> <span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">n2</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">n2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n3</span><span class="p">))]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pari</span><span class="p">(</span><span class="s">'x'</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">f</span> <span class="o">+=</span> <span class="n">crtcoef</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">crtcoef</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="mi">16</span><span class="p">))</span><span class="o">+</span><span class="n">r1</span><span class="p">)</span><span class="o">**</span><span class="mi">11</span> <span class="o">-</span> <span class="n">enc1</span><span class="p">)</span>
<span class="n">f</span> <span class="o">+=</span> <span class="n">crtcoef</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">crtcoef</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="mi">16</span><span class="p">))</span><span class="o">+</span><span class="n">r2</span><span class="p">)</span><span class="o">**</span><span class="mi">11</span> <span class="o">-</span> <span class="n">enc2</span><span class="p">)</span>
<span class="n">f</span> <span class="o">+=</span> <span class="n">crtcoef</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">crtcoef</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="mi">16</span><span class="p">))</span><span class="o">+</span><span class="n">r3</span><span class="p">)</span><span class="o">**</span><span class="mi">11</span> <span class="o">-</span> <span class="n">enc3</span><span class="p">)</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">pari</span><span class="p">.</span><span class="n">zncoppersmith</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">n1</span><span class="o">*</span><span class="n">n2</span><span class="o">*</span><span class="n">n3</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="p">((</span><span class="mi">49</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mi">8</span><span class="p">),</span> <span class="n">B</span><span class="o">=</span><span class="n">n1</span><span class="o">*</span><span class="n">n2</span><span class="o">*</span><span class="n">n3</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</code></pre></div></div>

<p><strong>Flag</strong></p>

<p>dice{r3s0rt_t0_LCG_4ft3r_f41l1ng_t0_m4k3_ch4ll}</p>

<p><br /></p>

<p>[+]<br />
Another easy solution is, as I mentioned, we can just create loop of 2 with a = -1.</p>

<p>When we think about it, the loop is made with these 2 elements: (seed, b - seed)</p>

<p>If b is an odd number with 50% probability, when we send a seed which is odd number, b - seed is always even, so it gets filtered.<br />
With this way, if we send 5 seeds: (11, b - 11, 13, b - 13, 15)</p>

<p>We can get 5 datas with e = (11, 11, 13, 13, 15).</p>

<p><br /></p>

<p>Coppersmith works for this method too. Probably even more accurate.</p>

</article>


      </div>
    </main>
  </body>
</html>